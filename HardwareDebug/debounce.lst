   1                             	r8	=	0xffef0
   2                             	r16	=	0xffee8
   3                             	r24	=	0xffee0
   4                             	r9	=	0xffef1
   5                             	r17	=	0xffee9
   6                             	r25	=	0xffee1
   7                             	r10	=	0xffef2
   8                             	r18	=	0xffeea
   9                             	r26	=	0xffee2
  10                             	r11	=	0xffef3
  11                             	r19	=	0xffeeb
  12                             	r27	=	0xffee3
  13                             	r12	=	0xffef4
  14                             	r20	=	0xffeec
  15                             	r28	=	0xffee4
  16                             	r13	=	0xffef5
  17                             	r21	=	0xffeed
  18                             	r29	=	0xffee5
  19                             	r14	=	0xffef6
  20                             	r22	=	0xffeee
  21                             	r30	=	0xffee6
  22                             	r15	=	0xffef7
  23                             	r23	=	0xffeef
  24                             	r31	=	0xffee7
  25                             	.text
  26                             	.Ltext0:
  27                             		.comm	_record,50,1
  28                             		.comm	_mem,50,1
  29                             		.comm	_display_string,50,1
  30                             		.comm	_scrollFlag,1,1
  31                             		.comm	_tempFlag,1,1
  32                             		.comm	_scrollCount,2,2
  33                             		.comm	_timerFlag,2,2
  34                             		.comm	_count,2,2
  35                             		.local	_low
  36                             		.comm	_low,16,2
  37                             		.local	_high
  38                             		.comm	_high,16,2
  39                             		.local	_flag
  40                             		.comm	_flag,16,2
  41                             		.global	_bounce_correction
  43                             	_bounce_correction:
  44                             	.LFB0:
  45                             		.file 1 "../src/debounce.c"
   1:../src/debounce.c **** /*
   2:../src/debounce.c **** 
   3:../src/debounce.c ****  * debounce.c
   4:../src/debounce.c ****  *
   5:../src/debounce.c ****  *  Created on: 12 Apr 2017
   6:../src/debounce.c ****  *      Author: 19119038
   7:../src/debounce.c ****  */
   8:../src/debounce.c **** 
   9:../src/debounce.c **** #include "r_cg_userdefine.h"
  10:../src/debounce.c **** #include "debounce.h"
  11:../src/debounce.c **** 
  12:../src/debounce.c **** static uint16_t low[8];
  13:../src/debounce.c **** static uint16_t high[8];
  14:../src/debounce.c **** static uint16_t flag[8];
  15:../src/debounce.c **** 
  16:../src/debounce.c **** uint8_t bounce_correction(volatile __BITS8 *port, int pin_no){
  46                             		.loc 1 16 0
  47                             		; start of function
  48                             		; outgoing: 4 bytes
  49 0000 20 04                   		subw	sp, #4
  50                             	.LCFI0:
  17:../src/debounce.c **** 
  18:../src/debounce.c **** 
  19:../src/debounce.c **** if(getPin(port, pin_no) == 1){
  51                             		.loc 1 19 0
  52 0002 A8 08                   		movw	ax, [sp+8]
  53 0004 BD F0                   		movw	r8, ax
  54 0006 B8 00                   		movw	[sp], ax
  55 0008 A8 0A                   		movw	ax, [sp+10]
  56 000a BD F0                   		movw	r8, ax
  57 000c B8 02                   		movw	[sp+2], ax
  58 000e FC 00 00 00             		call	!!%code(_getPin)
  59 0012 4A F0 01                		cmp	r8, #1
  60 0015 61 E8                   		 skz
  61 0017 EC 5E 00 00             		 br	!!.L2
  20:../src/debounce.c **** 	high[pin_no]++;
  62                             		.loc 1 20 0
  63 001b A8 0A                   		movw	ax, [sp+10]
  64 001d BD F0                   		movw	r8, ax
  65 001f 01                      		addw	ax, ax
  66 0020 BD F0                   		movw	r8, ax
  67 0022 04 10 00                		addw	ax, #_high
  68 0025 BD F0                   		movw	r8, ax
  69 0027 BD F2                   		movw	r10, ax
  70 0029 FA F2                   		movw	hl, r10
  71 002b AB                      		movw	ax, [hl]
  72 002c BD F0                   		movw	r8, ax
  73 002e A1                      		incw	ax
  74 002f BD F2                   		movw	r10, ax
  75 0031 A8 0A                   		movw	ax, [sp+10]
  76 0033 BD F0                   		movw	r8, ax
  77 0035 01                      		addw	ax, ax
  78 0036 BD F0                   		movw	r8, ax
  79 0038 04 10 00                		addw	ax, #_high
  80 003b BD F0                   		movw	r8, ax
  81 003d BD F4                   		movw	r12, ax
  82 003f DA F4                   		movw	bc, r12
  83 0041 AD F2                   		movw	ax, r10
  84 0043 78 00 00                		movw	[bc], ax
  21:../src/debounce.c **** 	low[pin_no] = 0;
  85                             		.loc 1 21 0
  86 0046 A8 0A                   		movw	ax, [sp+10]
  87 0048 BD F0                   		movw	r8, ax
  88 004a 01                      		addw	ax, ax
  89 004b BD F0                   		movw	r8, ax
  90 004d 04 00 00                		addw	ax, #_low
  91 0050 BD F0                   		movw	r8, ax
  92 0052 BD F2                   		movw	r10, ax
  93 0054 DA F2                   		movw	bc, r10
  94 0056 F6                      		clrw	ax
  95 0057 78 00 00                		movw	[bc], ax
  96 005a EC 9D 00 00             		br	!!.L3
  97                             	.L2:
  22:../src/debounce.c **** }
  23:../src/debounce.c **** else{
  24:../src/debounce.c **** 	low[pin_no]++;
  98                             		.loc 1 24 0
  99 005e A8 0A                   		movw	ax, [sp+10]
 100 0060 BD F0                   		movw	r8, ax
 101 0062 01                      		addw	ax, ax
 102 0063 BD F0                   		movw	r8, ax
 103 0065 04 00 00                		addw	ax, #_low
 104 0068 BD F0                   		movw	r8, ax
 105 006a BD F4                   		movw	r12, ax
 106 006c FA F4                   		movw	hl, r12
 107 006e AB                      		movw	ax, [hl]
 108 006f BD F0                   		movw	r8, ax
 109 0071 A1                      		incw	ax
 110 0072 BD F2                   		movw	r10, ax
 111 0074 A8 0A                   		movw	ax, [sp+10]
 112 0076 BD F0                   		movw	r8, ax
 113 0078 01                      		addw	ax, ax
 114 0079 BD F0                   		movw	r8, ax
 115 007b 04 00 00                		addw	ax, #_low
 116 007e BD F0                   		movw	r8, ax
 117 0080 BD F4                   		movw	r12, ax
 118 0082 DA F4                   		movw	bc, r12
 119 0084 AD F2                   		movw	ax, r10
 120 0086 78 00 00                		movw	[bc], ax
  25:../src/debounce.c **** 	high[pin_no] = 0;
 121                             		.loc 1 25 0
 122 0089 A8 0A                   		movw	ax, [sp+10]
 123 008b BD F0                   		movw	r8, ax
 124 008d 01                      		addw	ax, ax
 125 008e BD F0                   		movw	r8, ax
 126 0090 04 10 00                		addw	ax, #_high
 127 0093 BD F0                   		movw	r8, ax
 128 0095 BD F2                   		movw	r10, ax
 129 0097 DA F2                   		movw	bc, r10
 130 0099 F6                      		clrw	ax
 131 009a 78 00 00                		movw	[bc], ax
 132                             	.L3:
  26:../src/debounce.c **** }
  27:../src/debounce.c **** 
  28:../src/debounce.c **** if(high[pin_no] > 1250){
 133                             		.loc 1 28 0
 134 009d A8 0A                   		movw	ax, [sp+10]
 135 009f BD F0                   		movw	r8, ax
 136 00a1 01                      		addw	ax, ax
 137 00a2 BD F0                   		movw	r8, ax
 138 00a4 04 10 00                		addw	ax, #_high
 139 00a7 BD F0                   		movw	r8, ax
 140 00a9 BD F4                   		movw	r12, ax
 141 00ab FA F4                   		movw	hl, r12
 142 00ad AB                      		movw	ax, [hl]
 143 00ae BD F0                   		movw	r8, ax
 144 00b0 44 E2 04                		cmpw	ax, #1250
 145 00b3 61 E3                   		 skh
 146 00b5 EC 05 01 00             		 br	!!.L4
  29:../src/debounce.c **** 	high[pin_no] = 1251;
 147                             		.loc 1 29 0
 148 00b9 A8 0A                   		movw	ax, [sp+10]
 149 00bb BD F0                   		movw	r8, ax
 150 00bd 01                      		addw	ax, ax
 151 00be BD F0                   		movw	r8, ax
 152 00c0 04 10 00                		addw	ax, #_high
 153 00c3 BD F0                   		movw	r8, ax
 154 00c5 BD F2                   		movw	r10, ax
 155 00c7 DA F2                   		movw	bc, r10
 156 00c9 30 E3 04                		movw	ax, #1251
 157 00cc 78 00 00                		movw	[bc], ax
  30:../src/debounce.c **** 	if(flag[pin_no] == 0){
 158                             		.loc 1 30 0
 159 00cf A8 0A                   		movw	ax, [sp+10]
 160 00d1 BD F0                   		movw	r8, ax
 161 00d3 01                      		addw	ax, ax
 162 00d4 BD F0                   		movw	r8, ax
 163 00d6 04 20 00                		addw	ax, #_flag
 164 00d9 BD F0                   		movw	r8, ax
 165 00db BD F4                   		movw	r12, ax
 166 00dd FA F4                   		movw	hl, r12
 167 00df AB                      		movw	ax, [hl]
 168 00e0 BD F0                   		movw	r8, ax
 169 00e2 44 00 00                		cmpw	ax, #0
 170 00e5 61 E8                   		 skz
 171 00e7 EC 49 01 00             		 br	!!.L5
  31:../src/debounce.c **** 		flag[pin_no] = 1;
 172                             		.loc 1 31 0
 173 00eb A8 0A                   		movw	ax, [sp+10]
 174 00ed BD F0                   		movw	r8, ax
 175 00ef 01                      		addw	ax, ax
 176 00f0 BD F0                   		movw	r8, ax
 177 00f2 04 20 00                		addw	ax, #_flag
 178 00f5 BD F0                   		movw	r8, ax
 179 00f7 BD F2                   		movw	r10, ax
 180 00f9 DA F2                   		movw	bc, r10
 181 00fb E6                      		onew	ax
 182 00fc 78 00 00                		movw	[bc], ax
  32:../src/debounce.c **** 		return 1;
 183                             		.loc 1 32 0
 184 00ff E4 F0                   		oneb	r8
 185 0101 EC 4B 01 00             		br	!!.L6
 186                             	.L4:
  33:../src/debounce.c **** 	}
  34:../src/debounce.c **** }
  35:../src/debounce.c **** else if(low[pin_no] > 1250){
 187                             		.loc 1 35 0
 188 0105 A8 0A                   		movw	ax, [sp+10]
 189 0107 BD F0                   		movw	r8, ax
 190 0109 01                      		addw	ax, ax
 191 010a BD F0                   		movw	r8, ax
 192 010c 04 00 00                		addw	ax, #_low
 193 010f BD F0                   		movw	r8, ax
 194 0111 BD F4                   		movw	r12, ax
 195 0113 FA F4                   		movw	hl, r12
 196 0115 AB                      		movw	ax, [hl]
 197 0116 BD F0                   		movw	r8, ax
 198 0118 44 E2 04                		cmpw	ax, #1250
 199 011b 61 E3                   		 skh
 200 011d EC 49 01 00             		 br	!!.L5
  36:../src/debounce.c **** 		flag[pin_no] = 0;
 201                             		.loc 1 36 0
 202 0121 A8 0A                   		movw	ax, [sp+10]
 203 0123 BD F0                   		movw	r8, ax
 204 0125 01                      		addw	ax, ax
 205 0126 BD F0                   		movw	r8, ax
 206 0128 04 20 00                		addw	ax, #_flag
 207 012b BD F0                   		movw	r8, ax
 208 012d BD F2                   		movw	r10, ax
 209 012f DA F2                   		movw	bc, r10
 210 0131 F6                      		clrw	ax
 211 0132 78 00 00                		movw	[bc], ax
  37:../src/debounce.c **** 		low[pin_no] = 0;
 212                             		.loc 1 37 0
 213 0135 A8 0A                   		movw	ax, [sp+10]
 214 0137 BD F0                   		movw	r8, ax
 215 0139 01                      		addw	ax, ax
 216 013a BD F0                   		movw	r8, ax
 217 013c 04 00 00                		addw	ax, #_low
 218 013f BD F0                   		movw	r8, ax
 219 0141 BD F4                   		movw	r12, ax
 220 0143 DA F4                   		movw	bc, r12
 221 0145 F6                      		clrw	ax
 222 0146 78 00 00                		movw	[bc], ax
 223                             	.L5:
  38:../src/debounce.c **** }
  39:../src/debounce.c **** 
  40:../src/debounce.c **** return 0;
 224                             		.loc 1 40 0
 225 0149 F4 F0                   		clrb	r8
 226                             	.L6:
  41:../src/debounce.c **** 
  42:../src/debounce.c **** }
 227                             		.loc 1 42 0
 228 014b 10 04                   		addw	sp, #4
 229 014d D7                      		ret
 230                             	.LFE0:
 232                             		.global	_getPin
 234                             	_getPin:
 235                             	.LFB1:
  43:../src/debounce.c **** 
  44:../src/debounce.c **** unsigned char getPin(volatile __BITS8 *port, int pin_no){
 236                             		.loc 1 44 0
  45:../src/debounce.c **** 
  46:../src/debounce.c **** 	switch(pin_no){
 237                             		.loc 1 46 0
 238 014e A8 06                   		movw	ax, [sp+6]
 239 0150 BD F0                   		movw	r8, ax
 240 0152 44 03 00                		cmpw	ax, #3
 241 0155 61 F8                   		 sknz
 242 0157 EC FE 01 00             		 br	!!.L9
 243 015b AD F0                   		movw	ax, r8
 244 015d 44 03 00                		cmpw	ax, #3
 245 0160 71 FF                   		 xor1	CY, a.7
 246 0162 61 F3                   		 sknh
 247 0164 EC 8F 01 00             		 br	!!.L10
 248 0168 AD F0                   		movw	ax, r8
 249 016a 44 01 00                		cmpw	ax, #1
 250 016d 61 F8                   		 sknz
 251 016f EC D2 01 00             		 br	!!.L11
 252 0173 AD F0                   		movw	ax, r8
 253 0175 44 01 00                		cmpw	ax, #1
 254 0178 71 FF                   		 xor1	CY, a.7
 255 017a 61 F3                   		 sknh
 256 017c EC E8 01 00             		 br	!!.L12
 257 0180 AD F0                   		movw	ax, r8
 258 0182 44 00 00                		cmpw	ax, #0
 259 0185 61 F8                   		 sknz
 260 0187 EC C1 01 00             		 br	!!.L13
 261 018b EC 69 02 00             		br	!!.L8
 262                             	.L10:
 263 018f AD F0                   		movw	ax, r8
 264 0191 44 05 00                		cmpw	ax, #5
 265 0194 61 F8                   		 sknz
 266 0196 EC 2A 02 00             		 br	!!.L14
 267 019a AD F0                   		movw	ax, r8
 268 019c 44 05 00                		cmpw	ax, #5
 269 019f 71 FF                   		 xor1	CY, a.7
 270 01a1 61 D8                   		 sknc
 271 01a3 EC 14 02 00             		 br	!!.L15
 272 01a7 AD F0                   		movw	ax, r8
 273 01a9 44 06 00                		cmpw	ax, #6
 274 01ac 61 F8                   		 sknz
 275 01ae EC 40 02 00             		 br	!!.L16
 276 01b2 AD F0                   		movw	ax, r8
 277 01b4 44 07 00                		cmpw	ax, #7
 278 01b7 61 F8                   		 sknz
 279 01b9 EC 56 02 00             		 br	!!.L17
 280 01bd EC 69 02 00             		br	!!.L8
 281                             	.L13:
  47:../src/debounce.c **** 		case 0: return port->no0; break;
 282                             		.loc 1 47 0
 283 01c1 A8 04                   		movw	ax, [sp+4]
 284 01c3 BD F0                   		movw	r8, ax
 285 01c5 BD F2                   		movw	r10, ax
 286 01c7 EA F2                   		movw	de, r10
 287 01c9 89                      		mov	a, [de]
 288 01ca 5C 01                   		and	a, #1
 289 01cc 9D F0                   		mov	r8, a
 290 01ce EC 6C 02 00             		br	!!.L18
 291                             	.L11:
  48:../src/debounce.c **** 		case 1: return port->no1; break;
 292                             		.loc 1 48 0
 293 01d2 A8 04                   		movw	ax, [sp+4]
 294 01d4 BD F0                   		movw	r8, ax
 295 01d6 BD F2                   		movw	r10, ax
 296 01d8 FA F2                   		movw	hl, r10
 297 01da 8B                      		mov	a, [hl]
 298 01db 9D F0                   		mov	r8, a
 299 01dd 31 1A                   		shr	a, 1
 300 01df 9D F0                   		mov	r8, a
 301 01e1 5A F0 01                		and	r8, #1
 302 01e4 EC 6C 02 00             		br	!!.L18
 303                             	.L12:
  49:../src/debounce.c **** 		case 2: return port->no2; break;
 304                             		.loc 1 49 0
 305 01e8 A8 04                   		movw	ax, [sp+4]
 306 01ea BD F0                   		movw	r8, ax
 307 01ec BD F2                   		movw	r10, ax
 308 01ee FA F2                   		movw	hl, r10
 309 01f0 8B                      		mov	a, [hl]
 310 01f1 9D F0                   		mov	r8, a
 311 01f3 31 2A                   		shr	a, 2
 312 01f5 9D F0                   		mov	r8, a
 313 01f7 5A F0 01                		and	r8, #1
 314 01fa EC 6C 02 00             		br	!!.L18
 315                             	.L9:
  50:../src/debounce.c **** 		case 3: return port->no3; break;
 316                             		.loc 1 50 0
 317 01fe A8 04                   		movw	ax, [sp+4]
 318 0200 BD F0                   		movw	r8, ax
 319 0202 BD F2                   		movw	r10, ax
 320 0204 FA F2                   		movw	hl, r10
 321 0206 8B                      		mov	a, [hl]
 322 0207 9D F0                   		mov	r8, a
 323 0209 31 3A                   		shr	a, 3
 324 020b 9D F0                   		mov	r8, a
 325 020d 5A F0 01                		and	r8, #1
 326 0210 EC 6C 02 00             		br	!!.L18
 327                             	.L15:
  51:../src/debounce.c **** 		case 4: return port->no4; break;
 328                             		.loc 1 51 0
 329 0214 A8 04                   		movw	ax, [sp+4]
 330 0216 BD F0                   		movw	r8, ax
 331 0218 BD F2                   		movw	r10, ax
 332 021a FA F2                   		movw	hl, r10
 333 021c 8B                      		mov	a, [hl]
 334 021d 9D F0                   		mov	r8, a
 335 021f 31 4A                   		shr	a, 4
 336 0221 9D F0                   		mov	r8, a
 337 0223 5A F0 01                		and	r8, #1
 338 0226 EC 6C 02 00             		br	!!.L18
 339                             	.L14:
  52:../src/debounce.c **** 		case 5: return port->no5; break;
 340                             		.loc 1 52 0
 341 022a A8 04                   		movw	ax, [sp+4]
 342 022c BD F0                   		movw	r8, ax
 343 022e BD F2                   		movw	r10, ax
 344 0230 FA F2                   		movw	hl, r10
 345 0232 8B                      		mov	a, [hl]
 346 0233 9D F0                   		mov	r8, a
 347 0235 31 5A                   		shr	a, 5
 348 0237 9D F0                   		mov	r8, a
 349 0239 5A F0 01                		and	r8, #1
 350 023c EC 6C 02 00             		br	!!.L18
 351                             	.L16:
  53:../src/debounce.c **** 		case 6: return port->no6; break;
 352                             		.loc 1 53 0
 353 0240 A8 04                   		movw	ax, [sp+4]
 354 0242 BD F0                   		movw	r8, ax
 355 0244 BD F2                   		movw	r10, ax
 356 0246 FA F2                   		movw	hl, r10
 357 0248 8B                      		mov	a, [hl]
 358 0249 9D F0                   		mov	r8, a
 359 024b 31 6A                   		shr	a, 6
 360 024d 9D F0                   		mov	r8, a
 361 024f 5A F0 01                		and	r8, #1
 362 0252 EC 6C 02 00             		br	!!.L18
 363                             	.L17:
  54:../src/debounce.c **** 		case 7: return port->no7; break;
 364                             		.loc 1 54 0
 365 0256 A8 04                   		movw	ax, [sp+4]
 366 0258 BD F0                   		movw	r8, ax
 367 025a BD F2                   		movw	r10, ax
 368 025c FA F2                   		movw	hl, r10
 369 025e 8B                      		mov	a, [hl]
 370 025f 9D F0                   		mov	r8, a
 371 0261 31 7A                   		shr	a, 7
 372 0263 9D F0                   		mov	r8, a
 373 0265 EC 6C 02 00             		br	!!.L18
 374                             	.L8:
  55:../src/debounce.c **** 		default: return -1;
 375                             		.loc 1 55 0
 376 0269 CD F0 FF                		mov	r8, #-1
 377                             	.L18:
  56:../src/debounce.c **** 
  57:../src/debounce.c **** 	}
  58:../src/debounce.c **** 
  59:../src/debounce.c **** 	return 0;
  60:../src/debounce.c **** }
 378                             		.loc 1 60 0
 379 026c D7                      		ret
 380                             	.LFE1:
 420                             	.Letext0:
 421                             		.file 2 "../src/iodefine.h"
 422                             		.file 3 "../src/r_cg_macrodriver.h"
 423                             		.file 4 "../src/globals.h"
